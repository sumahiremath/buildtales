<!-- Additional Mermaid support for GitHub Pages -->
<script type="module">
  // Fallback Mermaid initialization
  if (typeof mermaid === 'undefined') {
    import('https://cdn.jsdelivr.net/npm/mermaid@11.6.0/dist/mermaid.esm.min.mjs').then(mermaidModule => {
      const mermaid = mermaidModule.default;
      mermaid.initialize({
        startOnLoad: true,
        theme: 'default',
        themeVariables: {
          primaryColor: '#157878',
          primaryTextColor: '#111',
          lineColor: '#999',
          fontSize: '16px',
          noteBkgColor: '#fffbe6',
          noteTextColor: '#333'
        },
        flowchart: {
          useMaxWidth: true,
          htmlLabels: true
        },
        timeline: {
          useMaxWidth: true,
          wrap: true
        },
        kanban: {
          useMaxWidth: true
        }
      });
      
      // Run Mermaid on any remaining diagrams
      mermaid.run({ querySelector: '.language-mermaid' });
      
      // Additional fallback for any diagrams that didn't render
      setTimeout(() => {
        const unrenderedDiagrams = document.querySelectorAll('.language-mermaid:not(:has(svg))');
        if (unrenderedDiagrams.length > 0) {
          mermaid.run({ querySelector: '.language-mermaid:not(:has(svg))' });
        }
      }, 1000);
    });
  }
</script>

<!-- Ensure proper rendering of Mermaid diagrams -->
<style>
  .language-mermaid {
    background: transparent;
    border: none;
    padding: 0;
    margin: 1rem 0;
  }
  
  .mermaid {
    text-align: center;
    margin: 1rem 0;
    max-width: 100%;
    overflow-x: auto;
  }
  
  /* Timeline specific styling */
  .mermaid .timeline {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  }
  
  /* Kanban specific styling */
  .mermaid .kanban {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  }
  
  /* Flowchart specific styling */
  .mermaid .flowchart {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  }
  
  /* Ensure diagrams are responsive */
  .mermaid svg {
    max-width: 100%;
    height: auto;
  }
  
  /* Fix for GitHub Pages rendering */
  .mermaid .label {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
  }
</style>
